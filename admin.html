<h2>PeopleGrid Admin</h2>
<input id="u" placeholder="Username">
<input id="p" placeholder="Password" type="password">
<button onclick="load()">Login</button>
<div id="out"></div>

<script>
let auth = "";

async function load(){
  auth = "Basic " + btoa(u.value+":"+p.value);

  const r = await fetch("https://peoplegrid.onrender.com/admin/workers",{
    headers:{Authorization:auth}
  });

  const data = await r.json();

  let html = "<h3>Workers</h3>";

  data.forEach(x=>{
    html += `
      <div style="border:1px solid black;padding:10px;margin:10px">
        <b>${x.name}</b><br>
        ${x.skill} â€“ ${x.city}<br>
        Phone: ${x.phone}<br>
        Email: ${x.email}<br>
        <button onclick="download('${x.resume}')">Download Resume</button>
      </div>
    `;
  });

  out.innerHTML = html;
}

async function download(file){
  const r = await fetch("https://peoplegrid.onrender.com/admin/resume/"+file,{
    headers:{Authorization:auth}
  });

  const blob = await r.blob();
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "resume";
  a.click();
}
</script>
